<HTML>

	<HEAD>
		<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
		
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script>
			<script src="/static/familytree.js"></script>
	</HEAD>
	<BODY>
		<div id="familytree" class="familytree"></div>
		
<script>

function csvJSON(csv){
  var lines=csv.split("\n");
  var result = [];
  var headers=lines[0].split(",");
  for(var i=1;i<lines.length;i++){
	  var obj = {};
	  var currentline=lines[i].split(",");
	  for(var j=0;j<headers.length;j++){
		  obj[headers[j]] = currentline[j];
	  }
	  result.push(obj);
  }
  return result; //JavaScript object
  //return JSON.stringify(result); //JSON
}
$(document).ready(function(){
$.ajax({
      url: '/index.csv',
      type: 'GET',
      contentType: 'text/csv',
      context: this,
      success: function(response) {
            // Here is my response. Now, I want it in a single file.
      }
}).done(function(resp){
	console.log("RESP",csvJSON(resp));
     	var family = new FamilyTree(document.getElementById("familytree"), {
            nodeBinding: {
                field_0: "name"
            },
            nodes: [
                { id: 1, pids: [2], name: "Amber McKenzie" },
                { id: 2, pids: [1], name: "Ava Field" },
                { id: 3, mid: 1, fid: 2, name: "Peter Stevens" }  
            ]
        });
});

});
</script>	
		
	</BODY>

</HTML>
